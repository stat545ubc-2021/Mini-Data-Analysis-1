---
title: "Mini Data Analysis Milestone 2"
output: html_document
---

# Welcome back to your mini data analysis project!

This time, we will explore more in depth the concept of *tidy data*, and hopefully investigate further into your research questions that you defined in milestone 1.

**NOTE**: The main purpose of the mini data analysis is to integrate what you learn in class in an analysis. Although each milestone provides a framework for you to conduct your analysis, it's possible that you might find the instructions too rigid for your data set. If this is the case, you may deviate from the instructions -- just make sure you're demonstrating a wide range of tools and techniques taught in this class.

Begin by loading your data and the tidyverse package below: 

```{r, message = FALSE}
library(datateachr) # <- might contain the data you picked!
library(tidyverse)
```

# Learning Objectives

By the end of this milestone, you should:

+ Become familiar with manipulating and summarizing your data in tibbles using `dplyr` and `tidyr`, with a research question in mind.
+ Understand what *tidy* data is, and how to create it. In milestone 3, we will explore when this might be useful.
+ Generate a reproducible and clear report using R Markdown.
+ Gain a greater understanding of how to use R to answer research questions about your data.

**Things to keep in mind**

+ Remember to document your code, be explicit about what you are doing, and write notes in this markdown document when you feel that context is required. Create your analysis as if someone else will be reading it! **There will be 2.5 points reserved for reproducibility, readability, and repo organization.**

+ Before working on each task, you should always keep in mind the specific **research question** that you're trying to answer.

# Task 1: Process and summarize your data (15 points)

From milestone 1, you should have an idea of the basic structure of your dataset (e.g. number of rows and columns, class types, etc.). Here, we will start investigating your data more in-depth using various data manipulation functions. 

### 1.1 (2.5 points) 

First, write out the 4 research questions you defined in milestone 1 were. This will guide your work through milestone 2:

<!-------------------------- Start your work below ---------------------------->
1. *How does having a mature rating effect the rating of games in different genre?*
2. *Which game genre have the highest rating? Has this changed overtime?*
3. *What are the effects of discounting a game, do they improve the rating of games?* 
4. *Do the number of achievements in a game affect their rating in various genres?*
<!----------------------------------------------------------------------------->

### 1.2 (10 points)

Now, for each of your four research questions, choose one task from options 1-4 (summarizing), and one other task from 4-8 (graphing). You should have 2 tasks done for each research question (8 total). Make sure it makes sense to do them! (e.g. don't use a numerical variables for a task that needs a categorical variable.). Comment on why each task helps (or doesn't!) answer the corresponding research question. 

Ensure that the output of each operation is printed! 

**Summarizing:**

1. Compute the *range*, *mean*, and *two other summary statistics* of **one numerical variable** across the groups of **one categorical variable** from your data.
2. Compute the number of observations for at least one of your categorical variables. Do not use the function `table()`!
3. Create a categorical variable with 3 or more groups from an existing numerical variable. You can use this new variable in the other tasks! *An example: age in years into "child, teen, adult, senior".*
4. Based on two categorical variables, calculate two summary statistics of your choosing.

**Graphing:**

5. Create a graph out of summarized variables that has at least two geom layers.
6. Create a graph of your choosing, make one of the axes logarithmic, and format the axes labels so that they are "pretty" or easier to read. 
7. Make a graph where it makes sense to customize the alpha transparency.
8. Create 3 histograms out of summarized variables, with each histogram having different sized bins. Pick the "best" one and explain why it is the best.

Make sure it's clear what research question you are doing each operation for!

<!------------------------- Start your work below ----------------------------->
***1.2.1 How does having a mature rating effect the rating of games in different genre?***

*Summarizing: Task 2*
```{R}
games_maturity_review <- steam_games %>% 
  mutate(mature = grepl("Mature", mature_content)) %>%
  select(id, all_reviews, mature) %>% 
  separate(all_reviews, sep=',', into=c("review", 'num_review'), remove=FALSE, extra = "drop", fill = "right") %>%
  filter(review %in% reviews)

games_maturity_review %>%
  group_by(review, mature) %>% 
  summarise(n=n())

```

The summary table above shows the number of observations grouped by review level and whether a game has a mature rating. We can see that there are less games that have mature rating at each review level. The group with the most observation is mixed review level without a mature rating. This is important summary table as it provides an overview of the organized data needed to answer this research question

*Graphing: Task 6*

```{R}
games_maturity_review %>%
  ggplot(aes(factor(review, levels = reviews))) +
  geom_bar() +
  facet_wrap(~mature, ncol = 1) + 
  scale_y_continuous(trans = 'log10') +
  coord_flip()
```

The graph above is a bar chart showing the frequency of games at each review level faceted based on whether it has maturity rating. As shown in the summary table above, the frequency of the games in each category ranges from 0 to 4292, thus I decided to use log10 scale. This makes the data easier to read and interpret. This graph is important as it directly answers the first part of the research question which is investigating the relationship between review level and maturity rating. 

***1.2.2 Which game genre have the highest rating? Has this changed overtime?***

*Summarizing: Task 2*

```{R}
steam_games %>%
  separate(genre, sep=',', into=c("genre"), remove=TRUE, extra = "drop", fill = "right") %>%
  group_by(genre) %>%
  summarize(n = n())
```

For this research question, I had trouble categorizing games into genres. The original data set had a column for genre, however, the values are a list of genres which is difficult to analyze and represent graphically. Therefore, I decided to take the first genre listed in each game as it's genre. 

The summary table above shows that number of observation for each genre. The value in the original genre column have a alphabetized list of genres, thus taking the first genre of each list will result bias in genre frequency. As shown in the table above, "Action" and "Adventure" has high n number because they tend to appear early in the list of genre in the original data set. This helps answer the research question as it shows the number of observation in the grouped data used to answer the questions. 

*Graphing: Task 2*
```{r, fig.width=5, fig.height=4}
steam_games %>%
  separate(genre, sep=',', into=c("genre"), remove=TRUE, extra = "drop", fill = "right") %>%
  drop_na(release_date) %>%
  mutate(release_date = format(as.Date(release_date, '%b %d, %Y'), format='%Y')) %>%
  mutate(release_date_group = case_when(release_date < 2010 ~ 'Pre 2010',
                                        release_date < 2015 ~ '2010-2015',
                                        release_date < 2020 ~ '2015-2020',
                                        TRUE ~ '2020+')) %>%
  ggplot(aes(reorder(genre,genre,function(x)-length(x)))) + 
  facet_wrap( ~release_date_group ) +
  geom_bar() + 
  scale_y_continuous(trans = 'log10') +
  coord_flip()

```
I investigated the relationship between release date and frequency of game genres to answer this research question. The data is faceted into 4 category based on their release date and the frequency of each game genre is plotted. Similar to the previous graph, the range of genre frequency is quite large, thus I decided to do a log10 transformation on the genre count. This graphs is the first step in answering the research question, next would be to take into consideration the review levels of each game. Some observations of the graph above is that over time there is a greater variety of games, for example, before 2015, there are few Massively Multiplayer games or games with gore whereas after 2015, there is an increase in frequency in these games. 



***1.2.3 What are the effects of discounting a game, do they improve the rating of games?***

*Summarizing: Task 1*
```{R}
game_reivew_price <- steam_games %>%
  separate(all_reviews, sep=',', into=c("review", 'num_review'), remove=FALSE, extra = "drop", fill = "right") %>%
  filter(review %in% reviews) %>%
  select(id, original_price, discount_price, review) %>%
  filter(original_price > discount_price) %>% 
  mutate(discount = original_price - discount_price) 

game_reivew_price %>%
  group_by(review) %>%
  summarize(mean_discount = mean(discount), 
            median_discount = median(discount),
            max_discount = max(discount),
            min_discount = min(discount),
            stdev_discount = sd(discount),
            n = n())
```

*Graphing: Task 7*
```{R}
game_reivew_price %>%
  ggplot(aes(factor(review, levels = reviews), discount)) +
  geom_jitter(alpha=0.3) + 
  coord_flip()
```
The jitter plot above explores the relationship between the amount discounted from the game and the review level. We hypothesized that games with larger discount may be associated with better reviews because people feel like they it is more worth it to get it on sale. The graph above shows that negative, very negative and mostly negative games tend to have less discount however, this may be due to simply having less games that are negatively reviewed as mentioned before. Not only are there more positively rated game with discounts but there is a much greater discount.  It is important to note that I have filtered out games with no discount (or discounted price greater than original price), hence, every dot in the plot is a game that has been discounted. I decided to add alpha transparency of 0.3 as there were many games that had a small discount. With the alpha transparency, it clearly shows more games with small discount were rated positively than negatively. 

***1.2.4 Do the number of achievements in a game affect their rating in various genres?***
*Summarizing: Task 1


<!----------------------------------------------------------------------------->

### 1.3 (2.5 points)

Based on the operations that you've completed, how much closer are you to answering your research questions? Think about what aspects of your research questions remain unclear. Can your research questions be refined, now that you've investigated your data a bit more? Which research questions are yielding interesting results?

<!------------------------- Write your answer here ---------------------------->


<!----------------------------------------------------------------------------->

# Task 2: Tidy your data (12.5 points)

In this task, we will do several exercises to reshape our data. The goal here is to understand how to do this reshaping with the `tidyr` package.

A reminder of the definition of *tidy* data:

- Each row is an **observation**
- Each column is a **variable**
- Each cell is a **value**

*Tidy'ing* data is sometimes necessary because it can simplify computation. Other times it can be nice to organize data so that it can be easier to understand when read manually. 

### 2.1 (2.5 points)

Based on the definition above, can you identify if your data is tidy or untidy? Go through all your columns, or if you have >8 variables, just pick 8, and explain whether the data is untidy or tidy.

<!--------------------------- Start your work below --------------------------->


<!----------------------------------------------------------------------------->

### 2.2 (5 points)

Now, if your data is tidy, untidy it! Then, tidy it back to it's original state.

If your data is untidy, then tidy it! Then, untidy it back to it's original state.

Be sure to explain your reasoning for this task. Show us the "before" and "after".

<!--------------------------- Start your work below --------------------------->


<!----------------------------------------------------------------------------->

### 2.3 (5 points)

Now, you should be more familiar with your data, and also have made progress in answering your research questions. Based on your interest, and your analyses, pick 2 of the 4 research questions to continue your analysis in milestone 3, and explain your decision. 

Try to choose a version of your data that you think will be appropriate to answer these 2 questions in milestone 3. Use between 4 and 8 functions that we've covered so far (i.e. by filtering, cleaning, tidy'ing, dropping irrelvant columns, etc.). 

<!--------------------------- Start your work below --------------------------->


<!----------------------------------------------------------------------------->

*When you are done, knit an `md` file. This is what we will mark! Make sure to open it and check that everything has knitted correctly before submitting your tagged release.*

### Attribution

Thanks to Victor Yuan for mostly putting this together. 